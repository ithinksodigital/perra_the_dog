<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>perra the dog | Behawiorystka ps√≥w</title>
  <meta name="description" content="Behawiorystka ps√≥w ‚Äî konsultacje, wizyty w domu, spacery treningowe i warsztaty. Budujƒô relacjƒô miƒôdzy TobƒÖ a psem bez przemocy, z szacunkiem i wiedzƒÖ.">
  <meta property="og:title" content="perra the dog | Behawiorystka ps√≥w">
  <meta property="og:description" content="Konsultacje behawioralne, wizyty w domu, spacery treningowe i warsztaty. Pomagam budowaƒá spokojnƒÖ wiƒô≈∫ z psem.">
  <meta property="og:type" content="website">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><text y='0.9em' font-size='24'>üêï</text></svg>">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Syne:wght@600;700;800&display=swap" rel="stylesheet" crossorigin>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <a href="#main" class="skip-link">Przejd≈∫ do tre≈õci</a>
  <nav class="nav">
    <a href="#" class="logo">perra<span> the dog</span></a>
    <div class="nav-right">
      <div class="accent-toggle" role="group" aria-label="Kolor akcentu">
        <button type="button" class="accent-option" data-accent="black" aria-pressed="false">Czarny</button>
        <button type="button" class="accent-option" data-accent="mint" aria-pressed="true">Miƒôtowy</button>
      </div>
      <ul id="nav-links" class="nav-links"><!-- wype≈Çniane z config.json --></ul>
    </div>
    <button class="nav-toggle" aria-label="Menu"><span></span><span></span><span></span></button>
  </nav>

  <nav id="dots" class="dots" aria-hidden="true"><!-- wype≈Çniane z config.json --></nav>

  <main id="main" class="onepage">
    <section id="hero" class="panel hero">
      <div class="hero-bg">
        <div class="hero-gradient"></div>
        <div class="hero-glow"></div>
        <div class="hero-grid"></div>
      </div>
      <div class="hero-inner">
        <p class="hero-label">Behawiorystka ps√≥w</p>
        <h1 class="hero-title">Zrozum swojego psa.<br>Zbuduj relacjƒô.</h1>
        <p class="hero-desc">Pomagam opiekunom i czworonogom budowaƒá spokojnƒÖ wiƒô≈∫ ‚Äî bez przemocy, z szacunkiem i wiedzƒÖ.</p>
        <div class="hero-cta">
          <a href="#rejestracja" class="btn btn-primary">Um√≥w konsultacjƒô</a>
          <a href="#uslugi" class="btn btn-ghost">Us≈Çugi</a>
        </div>
      </div>
      <div class="scroll-hint">
        <span>Przewi≈Ñ</span>
        <div class="scroll-line"></div>
      </div>
    </section>

    <section id="uslugi" class="panel section">
      <div class="wrap">
        <p class="label">Co oferujƒô</p>
        <h2 class="title">Us≈Çugi</h2>
        <div id="services-grid" class="services-grid" data-json="services.json">
          <!-- Karty us≈Çug ≈Çadowane z services.json -->
        </div>
      </div>
    </section>

    <section id="galeria" class="panel section section-tint">
      <div class="wrap">
        <p class="label">Zdjƒôcia</p>
        <h2 class="title">Galeria</h2>
        <p class="intro">Kadry z konsultacji, spacer√≥w i warsztat√≥w.</p>
        <div id="gallery-grid" class="gallery-grid" data-json="gallery.json">
          <!-- Zdjƒôcia ≈Çadowane z gallery.json -->
        </div>
      </div>
    </section>

    <section id="opinie" class="panel section">
      <div class="wrap">
        <p class="label">Co m√≥wiƒÖ opiekunowie</p>
        <h2 class="title">Opinie</h2>
        <p class="intro">S≈Çowa os√≥b, kt√≥re skorzysta≈Çy z konsultacji, spacer√≥w lub warsztat√≥w.</p>
        <div class="testimonials-slider">
          <div class="testimonials-track-wrap">
            <div id="testimonials-track" class="testimonials-track" data-json="testimonials.json"><!-- slajdy wstawiane z JS --></div>
          </div>
          <div class="testimonials-nav">
            <button type="button" class="testimonials-prev" aria-label="Poprzednia opinia">‚Üê</button>
            <div id="testimonials-dots" class="testimonials-dots" aria-hidden="true"></div>
            <button type="button" class="testimonials-next" aria-label="Nastƒôpna opinia">‚Üí</button>
          </div>
        </div>
      </div>
    </section>

    <section id="rejestracja" class="panel section section-tint">
      <div class="wrap">
        <p class="label">Zapisz siƒô</p>
        <h2 class="title">Rejestracja</h2>
        <p class="intro">Wybierz formƒô i wype≈Çnij formularz. Odpowiem najszybciej jak to mo≈ºliwe.</p>
        <div id="forms-container" class="forms-grid"><!-- wype≈Çniane z config.json --></div>
      </div>
    </section>

    <section id="kontakt" class="panel section">
      <div class="wrap">
        <p class="label">BƒÖd≈∫my w kontakcie</p>
        <h2 class="title">Social media</h2>
        <p class="intro">Porady, zdjƒôcia i inspiracje ‚Äî obserwuj tam, gdzie jeste≈õ.</p>
        <div id="socials-container" class="socials"><!-- wype≈Çniane z config.json --></div>
      </div>
    </section>
  </main>

  <footer class="footer">
    <div class="footer-inner wrap">
      <p class="footer-copy">¬© <span id="year"></span> perra the dog</p>
      <p id="footer-contact" class="footer-contact"><!-- wype≈Çniane z config.json --></p>
    </div>
  </footer>

  <div id="cookie-bar" class="cookie-bar" role="dialog" aria-label="Informacja o ciasteczkach">
    <p class="cookie-bar-text">Ta strona u≈ºywa ciasteczek. <a href="#polityka" id="cookie-policy-link">Polityka prywatno≈õci</a>.</p>
    <button type="button" class="cookie-bar-btn" id="cookie-bar-accept">OK</button>
  </div>

  <a href="#" id="back-to-top" class="back-to-top" aria-label="Przewi≈Ñ do g√≥ry">‚Üë</a>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    var ACCENT_KEY = 'perra-accent';
    function getAccent() {
      try { return localStorage.getItem(ACCENT_KEY) || 'mint'; } catch (e) { return 'mint'; }
    }
    function setAccent(value) {
      try { localStorage.setItem(ACCENT_KEY, value); } catch (e) {}
      document.body.classList.toggle('accent-mint', value === 'mint');
      document.querySelectorAll('.accent-option').forEach(function(btn) {
        var isActive = btn.getAttribute('data-accent') === value;
        btn.classList.toggle('active', isActive);
        btn.setAttribute('aria-pressed', isActive);
      });
    }
    document.body.classList.toggle('accent-mint', getAccent() === 'mint');
    document.querySelectorAll('.accent-option').forEach(function(btn) {
      btn.classList.toggle('active', btn.getAttribute('data-accent') === getAccent());
      btn.setAttribute('aria-pressed', btn.getAttribute('data-accent') === getAccent());
      btn.addEventListener('click', function() { setAccent(btn.getAttribute('data-accent')); });
    });

    var DEFAULT_CONFIG = {
      sections: [
        { id: 'hero', visible: true, order: 0, label: 'Start' },
        { id: 'uslugi', visible: true, order: 1, label: 'Us≈Çugi' },
        { id: 'galeria', visible: true, order: 2, label: 'Galeria' },
        { id: 'opinie', visible: true, order: 3, label: 'Opinie' },
        { id: 'rejestracja', visible: true, order: 4, label: 'Rejestracja' },
        { id: 'kontakt', visible: true, order: 5, label: 'Kontakt' }
      ],
      forms: [
        { title: 'Konsultacja behawioralna', description: 'Um√≥w pierwszƒÖ konsultacjƒô', url: '#' },
        { title: 'Warsztaty / szkolenia', description: 'Zapisz siƒô na warsztat grupowy', url: '#' }
      ],
      socials: [
        { name: 'Instagram', url: '#', icon: 'instagram' },
        { name: 'Facebook', url: '#', icon: 'facebook' }
      ],
      footer: { email: 'email@example.pl', phoneHref: '+48123456789', phoneDisplay: '+48 123 456 789' }
    };

    function escapeHtml(text) {
      var div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function applyConfig(cfg) {
      var sections = (cfg.sections || []).filter(function(s) { return s.visible !== false; }).sort(function(a, b) { return (a.order || 0) - (b.order || 0); });
      var main = document.getElementById('main');
      if (main) {
        var panels = [].slice.call(main.querySelectorAll('.panel'));
        var byId = {};
        panels.forEach(function(p) { byId[p.id] = p; });
        sections.forEach(function(s) {
          var el = byId[s.id];
          if (el) { el.style.display = ''; main.appendChild(el); }
        });
        panels.forEach(function(p) {
          if (sections.every(function(s) { return s.id !== p.id; })) p.style.display = 'none';
        });
      }

      var navLinks = document.getElementById('nav-links');
      if (navLinks) {
        navLinks.innerHTML = '';
        sections.forEach(function(s) {
          if (s.id === 'hero') return;
          var li = document.createElement('li');
          var a = document.createElement('a');
          a.href = '#' + s.id;
          a.textContent = s.label || s.id;
          li.appendChild(a);
          navLinks.appendChild(li);
        });
      }

      var dotsNav = document.getElementById('dots');
      if (dotsNav) {
        dotsNav.innerHTML = '';
        sections.forEach(function(s, i) {
          var a = document.createElement('a');
          a.href = s.id === 'hero' ? '#' : '#' + s.id;
          a.className = 'dot' + (i === 0 ? ' active' : '');
          a.setAttribute('data-section', s.id);
          a.setAttribute('aria-label', s.label || s.id);
          dotsNav.appendChild(a);
        });
      }

      var formsContainer = document.getElementById('forms-container');
      if (formsContainer && cfg.forms && cfg.forms.length) {
        formsContainer.innerHTML = '';
        cfg.forms.forEach(function(f) {
          var card = document.createElement('a');
          card.href = f.url || '#';
          card.target = '_blank';
          card.rel = 'noopener noreferrer';
          card.className = 'form-card';
          card.innerHTML = '<span class="form-card-title">' + escapeHtml(f.title || '') + '</span><span class="form-card-desc">' + escapeHtml(f.description || '') + '</span><span class="form-card-arrow">‚Üí</span>';
          formsContainer.appendChild(card);
        });
      }

      var socialsContainer = document.getElementById('socials-container');
      if (socialsContainer && cfg.socials && cfg.socials.length) {
        var igPath = "M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z";
        var fbPath = "M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z";
        socialsContainer.innerHTML = '';
        cfg.socials.forEach(function(s) {
          var a = document.createElement('a');
          a.href = s.url || '#';
          a.target = '_blank';
          a.rel = 'noopener noreferrer';
          a.className = 'social';
          a.setAttribute('aria-label', s.name || '');
          a.innerHTML = '<svg viewBox="0 0 24 24" fill="currentColor"><path d="' + (s.icon === 'instagram' ? igPath : fbPath) + '"/></svg><span>' + escapeHtml(s.name || '') + '</span>';
          socialsContainer.appendChild(a);
        });
      }

      var footerContact = document.getElementById('footer-contact');
      if (footerContact && cfg.footer) {
        var f = cfg.footer;
        var parts = [];
        if (f.email) parts.push('<a href="mailto:' + escapeHtml(f.email) + '">' + escapeHtml(f.email) + '</a>');
        if (f.phoneHref || f.phoneDisplay) parts.push('<a href="tel:' + escapeHtml((f.phoneHref || f.phoneDisplay || '').replace(/\s/g, '')) + '">' + escapeHtml(f.phoneDisplay || f.phoneHref || '') + '</a>');
        footerContact.innerHTML = parts.join('<span class="footer-sep">¬∑</span>');
      }
      updateDots();
    }

    fetch('config.json')
      .then(function(r) { return r.ok ? r.json() : Promise.reject(r); })
      .then(function(cfg) {
        applyConfig(cfg);
        loadData();
      })
      .catch(function() {
        applyConfig(DEFAULT_CONFIG);
        loadData();
      });

    function loadData() {
      var container = document.getElementById('services-grid');
      var jsonUrl = (container && container.getAttribute('data-json')) || 'services.json';
      function renderService(item, index) {
        var num = item.num != null ? String(item.num) : String(index + 1).padStart(2, '0');
        var card = document.createElement('article');
        card.className = 'card';
        card.innerHTML = '<span class="card-num">' + num + '</span><h3>' + escapeHtml(item.title || '') + '</h3><p>' + escapeHtml(item.description || item.desc || '') + '</p>';
        return card;
      }
      if (container) {
        fetch(jsonUrl).then(function(r) { return r.ok ? r.json() : Promise.reject(r); }).then(function(data) {
          var list = Array.isArray(data) ? data : (data.services || data.items || []);
          container.innerHTML = '';
          list.forEach(function(item, i) { container.appendChild(renderService(item, i)); });
        }).catch(function() { container.innerHTML = '<p class="services-fallback">Brak danych. Dodaj plik services.json.</p>'; });
      }

      var galleryEl = document.getElementById('gallery-grid');
      var galleryJsonUrl = (galleryEl && galleryEl.getAttribute('data-json')) || 'gallery.json';
      function renderPhoto(item) {
        var src = typeof item === 'string' ? item : (item.src || '');
        var alt = (typeof item === 'object' && item && item.alt) ? item.alt : '';
        var box = document.createElement('div');
        box.className = 'photo-box';
        var img = document.createElement('img');
        img.src = src;
        img.alt = alt;
        img.loading = 'lazy';
        img.onerror = function() { this.style.display = 'none'; this.parentElement.classList.add('photo-box--error'); };
        box.appendChild(img);
        if (alt) { var cap = document.createElement('span'); cap.className = 'photo-box-caption'; cap.textContent = alt; box.appendChild(cap); }
        return box;
      }
      if (galleryEl) {
        fetch(galleryJsonUrl).then(function(r) { return r.ok ? r.json() : Promise.reject(r); }).then(function(data) {
          var list = Array.isArray(data) ? data : (data.images || data.photos || data.items || []);
          galleryEl.innerHTML = '';
          list.forEach(function(item) { galleryEl.appendChild(renderPhoto(item)); });
        }).catch(function() { galleryEl.innerHTML = '<p class="services-fallback">Brak danych. Dodaj plik gallery.json.</p>'; });
      }

      var testimonialsTrack = document.getElementById('testimonials-track');
      var testimonialsJsonUrl = (testimonialsTrack && testimonialsTrack.getAttribute('data-json')) || 'testimonials.json';
      function renderTestimonialSlide(item) {
        var slide = document.createElement('div');
        slide.className = 'testimonial-slide';
        var card = document.createElement('blockquote');
        card.className = 'testimonial-card';
        card.innerHTML = '<p class="testimonial-quote">' + escapeHtml(item.quote || '') + '</p><footer class="testimonial-meta"><strong class="testimonial-author">' + escapeHtml(item.author || '') + '</strong>' + (item.context ? '<span class="testimonial-context">' + escapeHtml(item.context) + '</span>' : '') + '</footer>';
        slide.appendChild(card);
        return slide;
      }
      function initTestimonialsSlider(track) {
        var slides = track.querySelectorAll('.testimonial-slide');
        var n = slides.length;
        if (n === 0) return;
        var prevBtn = document.querySelector('.testimonials-prev');
        var nextBtn = document.querySelector('.testimonials-next');
        var dotsEl = document.getElementById('testimonials-dots');
        var idx = 0;
        function goTo(i) {
          idx = Math.max(0, Math.min(i, n - 1));
          track.style.transform = 'translateX(-' + idx * 100 + '%)';
          if (dotsEl) {
            var dots = dotsEl.querySelectorAll('button');
            dots.forEach(function(d, k) { d.classList.toggle('active', k === idx); d.setAttribute('aria-current', k === idx ? 'true' : 'false'); });
          }
        }
        if (dotsEl && n > 1) {
          dotsEl.innerHTML = '';
          for (var d = 0; d < n; d++) {
            var btn = document.createElement('button');
            btn.type = 'button';
            btn.className = 'testimonials-dot' + (d === 0 ? ' active' : '');
            btn.setAttribute('aria-label', 'Opinia ' + (d + 1));
            btn.setAttribute('aria-current', d === 0 ? 'true' : 'false');
            (function(k) { btn.addEventListener('click', function() { goTo(k); }); })(d);
            dotsEl.appendChild(btn);
          }
        }
        if (prevBtn) prevBtn.addEventListener('click', function() { goTo(idx - 1); });
        if (nextBtn) nextBtn.addEventListener('click', function() { goTo(idx + 1); });
        goTo(0);
      }
      if (testimonialsTrack) {
        fetch(testimonialsJsonUrl).then(function(r) { return r.ok ? r.json() : Promise.reject(r); }).then(function(data) {
          var list = Array.isArray(data) ? data : (data.testimonials || data.items || []);
          testimonialsTrack.innerHTML = '';
          list.forEach(function(item) { testimonialsTrack.appendChild(renderTestimonialSlide(item)); });
          initTestimonialsSlider(testimonialsTrack);
        }).catch(function() { testimonialsTrack.innerHTML = '<p class="services-fallback">Brak danych. Dodaj plik testimonials.json.</p>'; });
      }
    }

    document.querySelector('.nav-toggle').addEventListener('click', function() {
      var right = document.querySelector('.nav-right');
      if (right) right.classList.toggle('open');
      this.classList.toggle('open');
    });
    document.getElementById('nav-links').addEventListener('click', function(e) {
      if (e.target.tagName === 'A') {
        var right = document.querySelector('.nav-right');
        var toggle = document.querySelector('.nav-toggle');
        if (right) right.classList.remove('open');
        if (toggle) toggle.classList.remove('open');
      }
    });

    function updateDots() {
      var panels = document.querySelectorAll('.panel');
      var dots = document.querySelectorAll('.dot');
      if (!panels.length || !dots.length) return;
      var vh = window.innerHeight;
      var scroll = window.scrollY;
      var current = 'hero';
      panels.forEach(function(p) {
        var top = p.offsetTop;
        if (scroll >= top - vh * 0.4) current = p.id || current;
      });
      dots.forEach(function(d) {
        var href = d.getAttribute('href');
        var isActive = href === '#' ? current === 'hero' : href.slice(1) === current;
        d.classList.toggle('active', isActive);
      });
    }
    var scrollTick = false;
    function onScroll() {
      if (scrollTick) return;
      scrollTick = true;
      requestAnimationFrame(function() {
        updateDots();
        scrollTick = false;
      });
    }
    window.addEventListener('scroll', onScroll, { passive: true });
    window.addEventListener('load', updateDots);

    var backToTop = document.getElementById('back-to-top');
    if (backToTop) {
      function toggleBackToTop() {
        backToTop.classList.toggle('visible', window.scrollY > 400);
      }
      window.addEventListener('scroll', toggleBackToTop, { passive: true });
      window.addEventListener('load', toggleBackToTop);
      backToTop.addEventListener('click', function(e) {
        e.preventDefault();
        document.getElementById('main').scrollIntoView({ behavior: 'smooth', block: 'start' });
      });
    }

    document.querySelectorAll('.panel').forEach(function(panel) {
      var observer = new IntersectionObserver(function(entries) {
        entries.forEach(function(e) { if (e.isIntersecting) e.target.classList.add('in'); });
      }, { threshold: 0.15 });
      observer.observe(panel);
    });

    var COOKIE_CONSENT_KEY = 'perra-cookies-accepted';
    var cookieBar = document.getElementById('cookie-bar');
    if (cookieBar) {
      try {
        if (localStorage.getItem(COOKIE_CONSENT_KEY)) cookieBar.classList.add('hidden');
      } catch (e) {}
      document.getElementById('cookie-bar-accept').addEventListener('click', function() {
        try { localStorage.setItem(COOKIE_CONSENT_KEY, '1'); } catch (e) {}
        cookieBar.classList.add('hidden');
      });
    }
  </script>
</body>
</html>
